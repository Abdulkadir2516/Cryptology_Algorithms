function [KTh KT]=des_key(K)

ps1=[57 49 41 33 25 17 09 01 58 50 42 34 26 18 10 02 59 51 43 35 27 19 11 03 60 52 44 36 63 55 47 39 31 23 15 07 62 54 46 38 30 22 14 06 61 53 45 37 29 21 13 05 28 20 12 04];
ps2=[14 17 11 24 01 05 03 28 15 06 21 10 23 19 12 04 26 08 16 07 27 20 13 02 41 52 31 37 47 55 30 40 51 45 33 48 44 49 39 56 34 53 46 42 50 36 29 32];

K=K(ps1);
D=[1 1 2 2 2 2 2 2 1 2 2 2 2 2 2 1];

for i=1:16
    K1=K(1:28);
    K2=K(29:56);
    K1=[K1(D(i)+1:28) K1(1:D(i))];
    K2=[K2(D(i)+1:28) K2(1:D(i))];
    K=[K1 K2];
    Kx=K(ps2);
    KT(i,:)=Kx;
    k=1;
    for j=1:12
        Kh(j)=dec2hex(todec(Kx(k:k+3)));
        k=k+4;
    end
    KTh(i,:)=Kh;
end
